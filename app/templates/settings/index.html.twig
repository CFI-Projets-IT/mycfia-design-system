{% extends 'layouts/home.html.twig' %}

{% block title %}{{ 'settings.page.title'|trans({}, 'settings') }} - myCFiia{% endblock %}

{% block content %}
    <div class="container-fluid py-5">
        <div class="row justify-content-center">
            <div class="col-lg-8 col-xl-6">
                {# Flash Messages #}
                {% for message in app.flashes('success') %}
                    <div class="alert alert-success alert-dismissible fade show mb-4" role="alert">
                        <i class="bi bi-check-circle me-2"></i>
                        {{ message }}
                        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                    </div>
                {% endfor %}

                {% for message in app.flashes('error') %}
                    <div class="alert alert-danger alert-dismissible fade show mb-4" role="alert">
                        <i class="bi bi-exclamation-triangle me-2"></i>
                        {{ message }}
                        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                    </div>
                {% endfor %}

                {# En-tÃªte #}
                <div class="mb-4">
                    <h1 class="h3 mb-2">
                        <i class="bi bi-gear me-2"></i>{{ 'settings.page.title'|trans({}, 'settings') }}
                    </h1>
                    <p class="text-muted">
                        {{ 'settings.page.description'|trans({}, 'settings') }}
                    </p>
                </div>

                {# Formulaire de paramÃ¨tres #}
                <form method="post" action="{{ path('settings_update') }}">
                    <div class="card shadow-sm mb-4">
                        <div class="card-header bg-primary text-white">
                            <i class="bi bi-palette me-2"></i>
                            <strong>{{ 'settings.section.appearance.title'|trans({}, 'settings') }}</strong>
                        </div>
                        <div class="card-body">
                            {# SÃ©lecteur de thÃ¨me #}
                            <div class="mb-4">
                                <label class="form-label fw-bold">
                                    <i class="bi bi-brush me-2"></i>{{ 'settings.field.theme.label'|trans({}, 'settings') }}
                                </label>
                                <div class="btn-group w-100" role="group">
                                    <input type="radio" class="btn-check" name="theme" id="theme-light" value="light"
                                           {% if user.theme == 'light' %}checked{% endif %} autocomplete="off">
                                    <label class="btn btn-outline-primary" for="theme-light">
                                        <i class="bi bi-sun-fill me-2"></i>{{ 'settings.field.theme.light'|trans({}, 'settings') }}
                                    </label>

                                    <input type="radio" class="btn-check" name="theme" id="theme-dark-blue" value="dark-blue"
                                           {% if user.theme == 'dark-blue' %}checked{% endif %} autocomplete="off">
                                    <label class="btn btn-outline-primary" for="theme-dark-blue">
                                        <i class="bi bi-moon-stars-fill me-2"></i>{{ 'settings.field.theme.dark_blue'|trans({}, 'settings') }}
                                    </label>

                                    <input type="radio" class="btn-check" name="theme" id="theme-dark-red" value="dark-red"
                                           {% if user.theme == 'dark-red' %}checked{% endif %} autocomplete="off">
                                    <label class="btn btn-outline-primary" for="theme-dark-red">
                                        <i class="bi bi-moon-fill me-2"></i>{{ 'settings.field.theme.dark_red'|trans({}, 'settings') }}
                                    </label>
                                </div>
                                <div class="form-text">
                                    {{ 'settings.field.theme.help'|trans({}, 'settings') }}
                                </div>
                            </div>

                            {# SÃ©lecteur de langue #}
                            <div class="mb-3">
                                <label class="form-label fw-bold">
                                    <i class="bi bi-translate me-2"></i>{{ 'settings.field.locale.label'|trans({}, 'settings') }}
                                </label>
                                <div class="btn-group w-100" role="group">
                                    <input type="radio" class="btn-check" name="locale" id="locale-fr" value="fr"
                                           {% if user.locale == 'fr' %}checked{% endif %} autocomplete="off">
                                    <label class="btn btn-outline-primary" for="locale-fr">
                                        <span class="me-2">ðŸ‡«ðŸ‡·</span>{{ 'settings.field.locale.french'|trans({}, 'settings') }}
                                    </label>

                                    <input type="radio" class="btn-check" name="locale" id="locale-en" value="en"
                                           {% if user.locale == 'en' %}checked{% endif %} autocomplete="off">
                                    <label class="btn btn-outline-primary" for="locale-en">
                                        <span class="me-2">ðŸ‡¬ðŸ‡§</span>{{ 'settings.field.locale.english'|trans({}, 'settings') }}
                                    </label>
                                </div>
                                <div class="form-text">
                                    {{ 'settings.field.locale.help'|trans({}, 'settings') }}
                                </div>
                            </div>
                        </div>
                    </div>

                    {# Informations du compte (readonly) #}
                    <div class="card shadow-sm mb-4">
                        <div class="card-header bg-secondary text-white">
                            <i class="bi bi-info-circle me-2"></i>
                            <strong>{{ 'settings.section.account.title'|trans({}, 'settings') }}</strong>
                        </div>
                        <div class="card-body">
                            <table class="table table-sm table-borderless mb-0">
                                <tbody>
                                    <tr>
                                        <th style="width: 40%;">{{ 'settings.field.fullname.label'|trans({}, 'settings') }}</th>
                                        <td><strong>{{ user.fullName }}</strong></td>
                                    </tr>
                                    <tr>
                                        <th>{{ 'settings.field.email.label'|trans({}, 'settings') }}</th>
                                        <td>{{ user.email }}</td>
                                    </tr>
                                    <tr>
                                        <th>{{ 'settings.field.organization.label'|trans({}, 'settings') }}</th>
                                        <td>{{ user.division ? user.division.nomDivision : '-' }}</td>
                                    </tr>
                                    <tr>
                                        <th>{{ 'settings.field.id_cfi.label'|trans({}, 'settings') }}</th>
                                        <td><code class="text-info">{{ user.idCfi }}</code></td>
                                    </tr>
                                </tbody>
                            </table>

                            <div class="alert alert-info mb-0 mt-3" style="font-size: var(--font-size-sm);">
                                <i class="bi bi-lightbulb me-2"></i>
                                {{ 'settings.account.info'|trans({}, 'settings') }}
                                <a href="https://test.cfitech.io/" target="_blank" class="alert-link ms-2">
                                    {{ 'settings.account.open_cfi'|trans({}, 'settings') }} <i class="bi bi-box-arrow-up-right"></i>
                                </a>
                            </div>
                        </div>
                    </div>

                    {# Bouton de soumission #}
                    <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                        <a href="{{ path('home_index') }}" class="btn btn-outline-secondary">
                            <i class="bi bi-x-circle me-2"></i>{{ 'settings.button.cancel'|trans({}, 'settings') }}
                        </a>
                        <button type="submit" class="btn btn-primary">
                            <i class="bi bi-check-circle me-2"></i>{{ 'settings.button.save'|trans({}, 'settings') }}
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
{% endblock %}
